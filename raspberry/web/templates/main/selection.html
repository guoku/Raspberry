{% extends "base.html" %}
{% load web %}

{% block title %}精选{% endblock %}
{% block css %}<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}web/styles/selection.css">{% endblock %}

{% block content %}
    <h2>{{ curr_cat_title|default:'所有' }}</h2>

    <div id="selections">
        {% for selection in selection_list %}
            <div class="selection-item guoku-block">
                <div class="entity">
                    <h3>
                        <a href="{% url 'web.views.main.detail' selection.entity_context.entity_hash %}">
                            {% if selection.entity_context.brand|length != 0 %}{{ selection.entity_context.brand }}
                                - {% endif %}{{ selection.entity_context.title }}</a>
                    </h3>

                    <div class="entity-img-container">
                        <a href="{% url 'web.views.main.detail' selection.entity_context.entity_hash %}">
                            <img class="entity-img" src="{{ selection.entity_context.chief_image.url }}" alt="entity image">
                        </a>
                    </div>
                    <a href="javascript:;" class="like-entity{% if selection.already_like == True %} already-like{% endif %}"
                       data-entity="{{ selection.entity_context.entity_id }}">
                        喜爱 <small>{{ selection.entity_context.like_count }}</small>
                    </a>
                </div>

                <div class="note">
                    <div class="selection-note">
                        {% display_note selection.selection_note selection.entity_context user_context %}
                    </div>

                    <div class="common-note" style="display: none">
                        {% for note in selection.common_note_list %}
                            {% display_note note selection.entity_context user_context %}
                        {% endfor %}
                    </div>

                    <div class="operate">
                        <a href="javascript:;" class="show-note">还有 {{ selection.common_note_list|length }} 条点评</a>
                        &sdot;
                        <a href="{% url 'web.views.main.detail' selection.entity_context.entity_hash %}#addnote"
                           class="add-note">写点评</a>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

    {% if not user.is_authenticated %}
        {% include 'main/partial/display_login_block.html' %}
    {% endif %}

    <div class="categories guoku-block">
        <ul>
            <li><a href="{% url 'web.views.main.selection' %}">所有</a></li>
            {% for category in category_list %}
                <li><a href="{% url 'web.views.main.selection' %}?c={{ category.category_id }}">{{ category.category_title }}</a></li>
            {% endfor %}
        </ul>
    </div>

    {% include 'main/partial/app_download.html' %}
{% endblock %}